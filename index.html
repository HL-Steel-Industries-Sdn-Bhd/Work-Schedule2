<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡¹ç›®æ’ç­è¡¨</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            padding: 15px;
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.5;
        }
        h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        h3 {
            margin: 25px 0 15px;
            color: #34495e;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            overflow-x: auto;
        }
        .schedule-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        .projects-sidebar {
            width: 150px;
            flex-shrink: 0;
        }
        .project {
            padding: 12px 15px;
            background: #e74c3c;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 10px;
            font-size: 16px;
            user-select: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: center;
        }
        .project:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .project.dragging {
            opacity: 0.8;
            transform: scale(1.05);
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }
        .schedule {
            display: grid;
            grid-template-columns: 120px repeat(10, minmax(80px, 1fr));
            grid-auto-rows: minmax(50px, auto);
            gap: 2px;
            flex-grow: 1;
            min-width: 1000px;
        }
        .header, .time-header, .employee-name {
            color: white;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border-radius: 4px;
            padding: 10px;
        }
        .header { background: #3498db; }
        .time-header { background: #2c3e50; }
        .employee-name { background: #1abc9c; }
        .cell {
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            min-height: 50px;
            position: relative;
            border-radius: 4px;
            transition: background-color 0.2s;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .cell.highlight { background-color: #e8f4fd; border: 1px dashed #3498db; }
        .cell.occupied { background-color: #fff8e1; }
        .assigned-project {
            padding: 8px 12px;
            background: #e74c3c;
            color: white;
            border-radius: 4px;
            font-size: 14px;
            user-select: none;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: pointer;
            text-align: center;
            width: 100%;
            position: relative;
        }
        .assigned-project:hover { background: #c0392b; }
        .trash-btn {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 14px;
            cursor: pointer;
        }
        .instructions {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            font-size: 14px;
            border-left: 4px solid #3498db;
        }
        .instructions h4 { margin-bottom: 8px; color: #2c3e50; }
        .instructions ul { padding-left: 20px; }
        .instructions li { margin-bottom: 5px; }
        @media (max-width: 768px) {
            .schedule-container { flex-direction: column; }
            .projects-sidebar { width: 100%; }
            .schedule { grid-template-columns: 100px repeat(10, minmax(70px, 1fr)); min-width: 900px; }
            .project, .assigned-project { font-size: 14px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>é¡¹ç›®æ’ç­è¡¨</h2>
        <div class="schedule-container">
            <div class="projects-sidebar">
                <h3>å¯åˆ†é…é¡¹ç›®</h3>
                <div id="projects"></div>
            </div>
            <div class="schedule" id="schedule"></div>
        </div>
        <div class="instructions">
            <h4>ä½¿ç”¨è¯´æ˜</h4>
            <ul>
                <li><strong>æ¡Œé¢ç«¯</strong>: ç‚¹å‡»å¹¶æ‹–æ‹½é¡¹ç›®åˆ°å‘˜å·¥å¯¹åº”çš„æ—¶é—´å•å…ƒæ ¼</li>
                <li><strong>ç§»åŠ¨ç«¯</strong>: é•¿æŒ‰é¡¹ç›®ï¼Œç„¶åæ‹–åŠ¨åˆ°ç›®æ ‡å•å…ƒæ ¼</li>
                <li>æ¯ä¸ªæ ¼å­åªèƒ½åˆ†é…ä¸€ä¸ªé¡¹ç›®</li>
                <li>ç‚¹å‡»åƒåœ¾æ¡¶åˆ é™¤å·²åˆ†é…é¡¹ç›®</li>
            </ul>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const schedule = document.getElementById('schedule');
            const projectsContainer = document.getElementById('projects');

            // æ—¶é—´è¡¨å¤´
            const hours = [];
            for(let h = 8; h <= 17; h++) hours.push(`${h<10?'0'+h:h}:30`);
            const emptyHeader = document.createElement('div');
            emptyHeader.className = 'header'; emptyHeader.innerText = 'å‘˜å·¥/æ—¶é—´';
            schedule.appendChild(emptyHeader);
            hours.forEach(h => { const th=document.createElement('div'); th.className='time-header'; th.innerText=h; schedule.appendChild(th); });

            // å‘˜å·¥æ•°æ®
            const employees = [{id:'emp1',name:'å¼ ä¸‰'},{id:'emp2',name:'æå››'},{id:'emp3',name:'ç‹äº”'},{id:'emp4',name:'èµµå…­'},{id:'emp5',name:'é’±ä¸ƒ'}];

            employees.forEach(emp => {
                const empDiv=document.createElement('div');
                empDiv.className='employee-name'; empDiv.innerText=emp.name; schedule.appendChild(empDiv);

                hours.forEach(()=> {
                    const cell=document.createElement('div'); cell.className='cell';

                    function isCellOccupied(){return cell.querySelector('.assigned-project')!==null;}

                    // æ¡Œé¢ç«¯æ‹–æ”¾
                    cell.addEventListener('dragover', function(e){e.preventDefault(); if(!isCellOccupied()) this.classList.add('highlight');});
                    cell.addEventListener('dragleave', function(){this.classList.remove('highlight');});
                    cell.addEventListener('drop', function(e){
                        e.preventDefault(); this.classList.remove('highlight');
                        if(isCellOccupied()) return;
                        const id=e.dataTransfer.getData('text/plain'); const project=document.getElementById(id);
                        if(project){addProjectToCell(cell, project);}
                    });

                    // ç§»åŠ¨ç«¯è§¦æ‘¸
                    cell.addEventListener('touchmove', function(e){e.preventDefault();}, {passive:false});
                    cell.addEventListener('touchend', function(e){
                        if(isCellOccupied()) return;
                        const draggingProject=document.querySelector('.project.dragging');
                        if(draggingProject){addProjectToCell(cell, draggingProject); draggingProject.classList.remove('dragging');}
                    });

                    schedule.appendChild(cell);
                });
            });

            // é¡¹ç›®æ•°æ®
            const projects = [{id:'project1',name:'å‰ç«¯å¼€å‘'},{id:'project2',name:'åç«¯å¼€å‘'},{id:'project3',name:'UIè®¾è®¡'},{id:'project4',name:'æµ‹è¯•'},{id:'project5',name:'æ–‡æ¡£ç¼–å†™'}];

            projects.forEach(project=>{
                const projectDiv=document.createElement('div');
                projectDiv.className='project'; projectDiv.id=project.id; projectDiv.innerText=project.name; projectDiv.setAttribute('draggable','true');

                projectDiv.addEventListener('dragstart', function(e){e.dataTransfer.setData('text/plain', e.target.id); e.target.classList.add('dragging');});
                projectDiv.addEventListener('dragend', function(){this.classList.remove('dragging');});

                let touchStartX, touchStartY, isDragging=false;
                projectDiv.addEventListener('touchstart', function(e){touchStartX=e.touches[0].clientX; touchStartY=e.touches[0].clientY; isDragging=false;});
                projectDiv.addEventListener('touchmove', function(e){
                    if(!isDragging){const tx=e.touches[0].clientX, ty=e.touches[0].clientY; if(Math.abs(tx-touchStartX)>5||Math.abs(ty-touchStartY)>5){isDragging=true; this.classList.add('dragging');}}
                    if(isDragging) e.preventDefault();
                }, {passive:false});
                projectDiv.addEventListener('touchend', function(){if(isDragging) this.classList.remove('dragging');});

                projectsContainer.appendChild(projectDiv);
            });

            // å°è£…æ·»åŠ é¡¹ç›®åˆ°å•å…ƒæ ¼çš„å‡½æ•°
            function addProjectToCell(cell, project){
                const projectClone=project.cloneNode(true);
                projectClone.className='assigned-project';

                // åƒåœ¾æ¡¶
                const trash=document.createElement('span');
                trash.innerHTML='ğŸ—‘ï¸';
                trash.className='trash-btn';
                trash.title='åˆ é™¤é¡¹ç›®';
                trash.addEventListener('click', function(e){
                    e.stopPropagation();
                    projectClone.remove();
                    cell.classList.remove('occupied');
                });
                projectClone.appendChild(trash);

                // ç‚¹å‡»é¡¹ç›®æœ¬ä½“åˆ é™¤ï¼ˆå¯é€‰ï¼‰
                projectClone.addEventListener('click', function(e){ e.stopPropagation(); projectClone.remove(); cell.classList.remove('occupied'); });

                cell.appendChild(projectClone);
                cell.classList.add('occupied');
            }
        });
    </script>
</body>
</html>

